---
layout: post
---

# 解决本地Jekyll打不开文件问题

最近在Github Pages部署了一个个人博客，为了减少文件反复push，在本地能够预览到博客的效果，在本地搭建了Jekyll，方便博客的调试。可是，遇到一个很棘手的问题：使用`jekyll serve`运行博客时，打开的博客的路径如果包含中文或者空格，那么浏览器就会打开失败，提示找不到文件，并且如果路径包含中文，控制台显示的文件路径有乱码，如果路径包含空格，控制台下空格显示为'+'号。这应该是编码的问题了。  

另外，在`Git Bash`运行`jekyll serve --trace`时，如果打开的博客路径包含中文，控制台会提示以下信息：  
![Alt 出错信息](http://ww4.sinaimg.cn/large/6321ab24gw1e6nuk96mxrj20ht06cmyp.jpg)

### 解决方法：  

根据出错信息，打开`filehandler.rb`文件，找到`set_filename`方法，强行对路径名称使用UTF-8格式编码，并且防止空格被转换为'+'号，更改的代码如下：  

    def set_filename(req, res)
        res.filename = @root.dup
        path_info = req.path_info.force_encoding("ISO-8859-1").force_encoding("UTF-8").gsub(/[+]/, ' ').scan(%r|/[^/]*|)
        path_info.unshift("")  # dummy for checking @root dir