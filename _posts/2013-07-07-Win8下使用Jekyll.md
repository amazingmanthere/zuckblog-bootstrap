---
layout: post
---

# win8下使用jekyll

根据[Win8下安装Jekyll](http://blog.zuckchen.com/Win8%E4%B8%8B%E5%AE%89%E8%A3%85Jekyll/)这一篇完成win8下的jekyll的安装后，接下来开始折腾jekyll的使用了。  

### Step1  

启动控制台，cd到博客项目的根目录下，直接输入：`jekyll --server`，提示以下错误，
![](http://ww3.sinaimg.cn/large/6321ab24gw1e6downzfeej20hs02kmx9.jpg)  

上网一查，发现原来启动的命令更改了：
>The Jekyll Command

>For better clarity, Jekyll now accepts the commands build and serve. Whereas before you might simply run the command jekyll to generate a site and jekyll --server to view it locally, now use the subcommands jekyll build and jekyll serve to do the same. And if you want Jekyll to automatically rebuild each time a file changes, just add the --watch flag at the end.sss  

这时尝试输入：`jekyll serve`，上面的错误果然消失了。  
  
### Step2 

But，新的错误也随之出现了，提示：  

    Liquid Exception: invalid byte sequence in GBK in 2012-08-25-hello-world.html
google了一下，发现一个解决方法：
>将E:\Jekyll\Ruby193\lib\ruby\gems\1.9.1\gems\jekyll-0.12.1\lib\jekyll\convertible.rb文件的28行  
self.content = File.read(File.join(base, name))
改为  
self.content = File.read(File.join(base, name), :encoding => "utf-8")
重启jekyll服务即可.
果断修改convertible.rb文件，并再次运行`jekyll serve`。上面的错误消失。

### Step3  

还是But，生成失败，提示权限拒绝。刚开始以为是权限问题，改为管理员的模式启动控制台，问题依旧存在。于是怀疑是markdown解释器的问题。根据网上的资料，输入： `gem install rdiscount`（**PS：如果安装失败，错误信息为：`Could not find a valid gem 'rdiscount' (>= 0)`，参考[Win8下安装Jekyll](http://blog.zuckchen.com/Win8%E4%B8%8B%E5%AE%89%E8%A3%85Jekyll/)**），更换解释器为rdiscount。并再次运行`jekyll serve`，问题解决，Generating显示Done，终于成功生成。  

### Step4  

接下来，打开浏览器，访问<http://localhost:4000/>，结果却提示\`/' not found，控制台也显示``ERROR `/' not found``，如下图所示：  
![](http://ww4.sinaimg.cn/large/6321ab24gw1e6doie7hp8j20az03j0sp.jpg)  
这时心都凉了，只能先从错误信息入手了。输入`jekyll serve -t`，尝试去获取错误信息，捣鼓了半天，还是没什么头绪，最后还是在官网上找到答案：
>Often, you’ll want the ability to run a Jekyll site in multiple places, such as previewing locally before pushing to GitHub Pages. Jekyll 1.0 makes that easier with the new --baseurl flag. To take advantage of this feature, first add the production baseurl to your site’s \_config.yml file. Then, throughout the site, simply prefix relative URLs with {{ site.baseurl }}. When you’re ready to preview your site locally, pass along the --baseurl flag with your local baseurl (most likely /) to jekyll serve and Jekyll will swap in whatever you’ve passed along, ensuring all your links work as you’d expect in both environments.  

原来本地运行jekyll时，项目的根目录应为`/`，但是我在根目录的_config.yml文件中，定义了baseurl，定义如下：  

    baseurl: /jekyll_demo
也就是说，本地预览时，访问的首页正确路径应为：`/index.html`，但是由于在_config.yml文件中定义了baseurl属性，真正访问到的路径是：`/jekyll_demo/index.html`，这导致了上面的错误，可以通过用/代替baseurl解决。于是无奈地输入：`jekyll serve --baseurl /`，然后刷新http://localhost:4000/，首页终于成功显示出来了，真折腾人呀！！！    
### Step5

**最后，得出一个结论，官方的文档还是要仔细看呀！！！**

## 参考

1. <http://www.duzengqiang.com/blog/post/979.html>
2. <http://jekyllrb.com/docs/upgrading/>
3. <http://www.mceiba.com/develop/jekyll-introduction.html>